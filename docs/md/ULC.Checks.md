<pre class="Agda">
<a id="14" class="Symbol">{-#</a> <a id="18" class="Keyword">OPTIONS</a> <a id="26" class="Pragma">--rewriting</a> <a id="38" class="Pragma">--confluence-check</a> <a id="57" class="Symbol">#-}</a>

<a id="62" class="Keyword">open</a> <a id="67" class="Keyword">import</a> <a id="74" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>
<a id="96" class="Keyword">open</a> <a id="101" class="Keyword">import</a> <a id="108" href="Agda.Builtin.Equality.Rewrite.html" class="Module">Agda.Builtin.Equality.Rewrite</a>

<a id="139" class="Keyword">module</a> <a id="146" href="ULC.Checks.html" class="Module">ULC.Checks</a> <a id="157" class="Keyword">where</a>

<a id="164" class="Keyword">open</a> <a id="169" class="Keyword">import</a> <a id="176" href="ULC.Domains.html" class="Module">ULC.Domains</a>
<a id="188" class="Keyword">open</a> <a id="193" class="Keyword">import</a> <a id="200" href="ULC.Variables.html" class="Module">ULC.Variables</a>
<a id="214" class="Keyword">open</a> <a id="219" class="Keyword">import</a> <a id="226" href="ULC.Terms.html" class="Module">ULC.Terms</a>
<a id="236" class="Keyword">open</a> <a id="241" class="Keyword">import</a> <a id="248" href="ULC.Semantics.html" class="Module">ULC.Semantics</a>

<a id="263" class="Keyword">open</a> <a id="268" class="Keyword">import</a> <a id="275" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="313" class="Keyword">using</a> <a id="319" class="Symbol">(</a><a id="320" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="324" class="Symbol">)</a>
<a id="326" class="Keyword">open</a> <a id="331" href="Function.Bundles.html#7340" class="Module">Inverse</a> <a id="339" class="Keyword">using</a> <a id="345" class="Symbol">(</a><a id="346" href="Function.Bundles.html#7570" class="Function">inverseˡ</a><a id="354" class="Symbol">;</a> <a id="356" href="Function.Bundles.html#7642" class="Function">inverseʳ</a><a id="364" class="Symbol">)</a>

<a id="to-from-elim"></a><a id="367" href="ULC.Checks.html#367" class="MissingDefinition Function">to-from-elim</a> <a id="380" class="Symbol">:</a> <a id="382" class="Symbol">∀</a> <a id="384" class="Symbol">{</a><a id="385" href="ULC.Checks.html#385" class="Bound">f</a><a id="386" class="Symbol">}</a>  <a id="389" class="Symbol">→</a>  <a id="392" href="Function.Bundles.html#7394" class="Field">to</a> <a id="395" class="Symbol">(</a><a id="396" href="Function.Bundles.html#7418" class="Field">from</a> <a id="401" href="ULC.Checks.html#385" class="Bound">f</a><a id="402" class="Symbol">)</a>  <a id="405" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="407" href="ULC.Checks.html#385" class="Bound">f</a>
<a id="409" href="ULC.Checks.html#367" class="MissingDefinition Function">to-from-elim</a>  <a id="423" class="Symbol">=</a> <a id="425" href="Function.Bundles.html#7570" class="Function">inverseˡ</a> <a id="434" href="ULC.Domains.html#183" class="Postulate">iso</a> <a id="438" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="from-to-elim"></a><a id="444" href="ULC.Checks.html#444" class="Function">from-to-elim</a> <a id="457" class="Symbol">:</a> <a id="459" class="Symbol">∀</a> <a id="461" class="Symbol">{</a><a id="462" href="ULC.Checks.html#462" class="Bound">d</a><a id="463" class="Symbol">}</a>  <a id="466" class="Symbol">→</a>  <a id="469" href="Function.Bundles.html#7418" class="Field">from</a> <a id="474" class="Symbol">(</a><a id="475" href="Function.Bundles.html#7394" class="Field">to</a> <a id="478" href="ULC.Checks.html#462" class="Bound">d</a><a id="479" class="Symbol">)</a>  <a id="482" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="484" href="ULC.Checks.html#462" class="Bound">d</a>
<a id="486" href="ULC.Checks.html#444" class="Function">from-to-elim</a>  <a id="500" class="Symbol">=</a> <a id="502" href="Function.Bundles.html#7642" class="Function">inverseʳ</a> <a id="511" href="ULC.Domains.html#183" class="Postulate">iso</a> <a id="515" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="521" class="Symbol">{-#</a> <a id="525" class="Keyword">REWRITE</a> <a id="533" href="ULC.Checks.html#367" class="Function">to-from-elim</a> <a id="546" class="Symbol">#-}</a>

<a id="551" class="Comment">-- The following proofs are potentially unsound,</a>
<a id="600" class="Comment">-- due to rewriting using the postulated iso</a>

<a id="646" class="Comment">-- (λx1.x1)x42 = x42</a>
<a id="check-id"></a><a id="667" href="ULC.Checks.html#667" class="Function">check-id</a> <a id="676" class="Symbol">:</a>
  <a id="680" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="682" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="686" class="Symbol">(</a><a id="687" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="691" class="Symbol">(</a><a id="692" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="694" class="Number">1</a><a id="695" class="Symbol">)</a> <a id="697" class="Symbol">(</a><a id="698" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="702" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="704" class="Number">1</a><a id="705" class="Symbol">))</a>
        <a id="716" class="Symbol">(</a><a id="717" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="721" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="723" class="Number">42</a><a id="725" class="Symbol">)</a> <a id="727" href="ULC.Semantics.html#144" class="Function Operator">⟧</a> <a id="729" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="731" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="733" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="737" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="739" class="Number">42</a> <a id="742" href="ULC.Semantics.html#144" class="Function Operator">⟧</a>
<a id="744" href="ULC.Checks.html#667" class="Function">check-id</a> <a id="753" class="Symbol">=</a> <a id="755" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="761" class="Comment">-- (λx1.x42)x0 = x42</a>
<a id="check-const"></a><a id="782" href="ULC.Checks.html#782" class="Function">check-const</a> <a id="794" class="Symbol">:</a>
  <a id="798" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="800" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="804" class="Symbol">(</a><a id="805" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="809" class="Symbol">(</a><a id="810" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="812" class="Number">1</a><a id="813" class="Symbol">)</a> <a id="815" class="Symbol">(</a><a id="816" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="820" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="822" class="Number">42</a><a id="824" class="Symbol">))</a>
        <a id="835" class="Symbol">(</a><a id="836" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="840" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="842" class="Number">0</a><a id="843" class="Symbol">)</a> <a id="845" href="ULC.Semantics.html#144" class="Function Operator">⟧</a> <a id="847" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="849" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="851" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="855" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="857" class="Number">42</a> <a id="860" href="ULC.Semantics.html#144" class="Function Operator">⟧</a>
<a id="862" href="ULC.Checks.html#782" class="Function">check-const</a> <a id="874" class="Symbol">=</a> <a id="876" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> 

<a id="883" class="Comment">-- (λx0.x0 x0)(λx0.x0 x0) = ...</a>
<a id="915" class="Comment">-- check-divergence :</a>
<a id="937" class="Comment">--   ⟦ app (lam (x 0) (app (var x 0) (var x 0))) </a>
<a id="987" class="Comment">--         (lam (x 0) (app (var x 0) (var x 0))) ⟧</a>
<a id="1038" class="Comment">--   ≡ ⟦ var x 42 ⟧</a>
<a id="1058" class="Comment">-- check-divergence = refl </a>

<a id="1087" class="Comment">-- (λx1.x42)((λx0.x0 x0)(λx0.x0 x0)) = x42</a>
<a id="check-convergence"></a><a id="1130" href="ULC.Checks.html#1130" class="Function">check-convergence</a> <a id="1148" class="Symbol">:</a>
  <a id="1152" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="1154" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="1158" class="Symbol">(</a><a id="1159" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1163" class="Symbol">(</a><a id="1164" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1166" class="Number">1</a><a id="1167" class="Symbol">)</a> <a id="1169" class="Symbol">(</a><a id="1170" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1174" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1176" class="Number">42</a><a id="1178" class="Symbol">))</a>
        <a id="1189" class="Symbol">(</a><a id="1190" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="1194" class="Symbol">(</a><a id="1195" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1199" class="Symbol">(</a><a id="1200" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1202" class="Number">0</a><a id="1203" class="Symbol">)</a> <a id="1205" class="Symbol">(</a><a id="1206" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="1210" class="Symbol">(</a><a id="1211" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1215" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1217" class="Number">0</a><a id="1218" class="Symbol">)</a> <a id="1220" class="Symbol">(</a><a id="1221" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1225" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1227" class="Number">0</a><a id="1228" class="Symbol">)))</a> 
             <a id="1246" class="Symbol">(</a><a id="1247" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1251" class="Symbol">(</a><a id="1252" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1254" class="Number">0</a><a id="1255" class="Symbol">)</a> <a id="1257" class="Symbol">(</a><a id="1258" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="1262" class="Symbol">(</a><a id="1263" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1267" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1269" class="Number">0</a><a id="1270" class="Symbol">)</a> <a id="1272" class="Symbol">(</a><a id="1273" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1277" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1279" class="Number">0</a><a id="1280" class="Symbol">))))</a> <a id="1285" href="ULC.Semantics.html#144" class="Function Operator">⟧</a>
  <a id="1289" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1291" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="1293" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1297" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1299" class="Number">42</a> <a id="1302" href="ULC.Semantics.html#144" class="Function Operator">⟧</a>
<a id="1304" href="ULC.Checks.html#1130" class="Function">check-convergence</a> <a id="1322" class="Symbol">=</a> <a id="1324" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> 

<a id="1331" class="Comment">-- (λx1.x1)(λx1.x42) = λx2.x42</a>
<a id="check-abs"></a><a id="1362" href="ULC.Checks.html#1362" class="Function">check-abs</a> <a id="1372" class="Symbol">:</a>
  <a id="1376" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="1378" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="1382" class="Symbol">(</a><a id="1383" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1387" class="Symbol">(</a><a id="1388" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1390" class="Number">1</a><a id="1391" class="Symbol">)</a> <a id="1393" class="Symbol">(</a><a id="1394" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1398" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1400" class="Number">1</a><a id="1401" class="Symbol">))</a>
        <a id="1412" class="Symbol">(</a><a id="1413" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1417" class="Symbol">(</a><a id="1418" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1420" class="Number">1</a><a id="1421" class="Symbol">)</a> <a id="1423" class="Symbol">(</a><a id="1424" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1428" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1430" class="Number">42</a><a id="1432" class="Symbol">))</a> <a id="1435" href="ULC.Semantics.html#144" class="Function Operator">⟧</a>
     <a id="1442" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1444" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="1446" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1450" class="Symbol">(</a><a id="1451" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1453" class="Number">2</a><a id="1454" class="Symbol">)</a> <a id="1456" class="Symbol">(</a><a id="1457" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1461" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1463" class="Number">42</a><a id="1465" class="Symbol">)</a> <a id="1467" href="ULC.Semantics.html#144" class="Function Operator">⟧</a>
<a id="1469" href="ULC.Checks.html#1362" class="Function">check-abs</a> <a id="1479" class="Symbol">=</a> <a id="1481" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="1487" class="Comment">-- (λx1.(λx42.x1)x2)x42 = x42</a>
<a id="check-free"></a><a id="1517" href="ULC.Checks.html#1517" class="Function">check-free</a> <a id="1528" class="Symbol">:</a>
  <a id="1532" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="1534" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="1538" class="Symbol">(</a><a id="1539" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1543" class="Symbol">(</a><a id="1544" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1546" class="Number">1</a><a id="1547" class="Symbol">)</a> 
          <a id="1560" class="Symbol">(</a><a id="1561" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="1565" class="Symbol">(</a><a id="1566" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1570" class="Symbol">(</a><a id="1571" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1573" class="Number">42</a><a id="1575" class="Symbol">)</a> <a id="1577" class="Symbol">(</a><a id="1578" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1582" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1584" class="Number">1</a><a id="1585" class="Symbol">))</a>
               <a id="1603" class="Symbol">(</a><a id="1604" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1608" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1610" class="Number">2</a><a id="1611" class="Symbol">)))</a>
        <a id="1623" class="Symbol">(</a><a id="1624" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1628" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1630" class="Number">42</a><a id="1632" class="Symbol">)</a> <a id="1634" href="ULC.Semantics.html#144" class="Function Operator">⟧</a> <a id="1636" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1638" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="1640" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1644" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1646" class="Number">42</a> <a id="1649" href="ULC.Semantics.html#144" class="Function Operator">⟧</a>
<a id="1651" href="ULC.Checks.html#1517" class="Function">check-free</a> <a id="1662" class="Symbol">=</a> <a id="1664" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
</pre> 