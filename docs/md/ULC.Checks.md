<pre class="Agda">
<a id="14" class="Symbol">{-#</a> <a id="18" class="Keyword">OPTIONS</a> <a id="26" class="Pragma">--rewriting</a> <a id="38" class="Pragma">--confluence-check</a> <a id="57" class="Symbol">#-}</a>

<a id="62" class="Keyword">open</a> <a id="67" class="Keyword">import</a> <a id="74" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>
<a id="96" class="Keyword">open</a> <a id="101" class="Keyword">import</a> <a id="108" href="Agda.Builtin.Equality.Rewrite.html" class="Module">Agda.Builtin.Equality.Rewrite</a>

<a id="139" class="Keyword">module</a> <a id="146" href="ULC.Checks.html" class="Module">ULC.Checks</a> <a id="157" class="Keyword">where</a>

<a id="164" class="Keyword">open</a> <a id="169" class="Keyword">import</a> <a id="176" href="ULC.Domains.html" class="Module">ULC.Domains</a>
<a id="188" class="Keyword">open</a> <a id="193" class="Keyword">import</a> <a id="200" href="ULC.Variables.html" class="Module">ULC.Variables</a>
<a id="214" class="Keyword">open</a> <a id="219" class="Keyword">import</a> <a id="226" href="ULC.Terms.html" class="Module">ULC.Terms</a>
<a id="236" class="Keyword">open</a> <a id="241" class="Keyword">import</a> <a id="248" href="ULC.Semantics.html" class="Module">ULC.Semantics</a>

<a id="263" class="Keyword">open</a> <a id="268" class="Keyword">import</a> <a id="275" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="313" class="Keyword">using</a> <a id="319" class="Symbol">(</a><a id="320" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="324" class="Symbol">)</a>
<a id="326" class="Keyword">open</a> <a id="331" href="Function.Bundles.html#7340" class="Module">Inverse</a> <a id="339" class="Keyword">using</a> <a id="345" class="Symbol">(</a><a id="346" href="Function.Bundles.html#7570" class="Function">inverseˡ</a><a id="354" class="Symbol">;</a> <a id="356" href="Function.Bundles.html#7642" class="Function">inverseʳ</a><a id="364" class="Symbol">)</a>

<a id="to-from"></a><a id="367" href="ULC.Checks.html#367" class="Function">to-from</a> <a id="375" class="Symbol">:</a> <a id="377" class="Symbol">∀{</a><a id="379" href="ULC.Checks.html#379" class="Bound">f</a><a id="380" class="Symbol">}</a>  <a id="383" class="Symbol">→</a>  <a id="386" href="Function.Bundles.html#7394" class="Field">to</a> <a id="389" class="Symbol">(</a><a id="390" href="Function.Bundles.html#7418" class="Field">from</a> <a id="395" href="ULC.Checks.html#379" class="Bound">f</a><a id="396" class="Symbol">)</a>  <a id="399" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="401" href="ULC.Checks.html#379" class="Bound">f</a>
<a id="from-to"></a><a id="403" href="ULC.Checks.html#403" class="Function">from-to</a> <a id="411" class="Symbol">:</a> <a id="413" class="Symbol">∀{</a><a id="415" href="ULC.Checks.html#415" class="Bound">d</a><a id="416" class="Symbol">}</a>  <a id="419" class="Symbol">→</a>  <a id="422" href="Function.Bundles.html#7418" class="Field">from</a> <a id="427" class="Symbol">(</a><a id="428" href="Function.Bundles.html#7394" class="Field">to</a> <a id="431" href="ULC.Checks.html#415" class="Bound">d</a><a id="432" class="Symbol">)</a>  <a id="435" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="437" href="ULC.Checks.html#415" class="Bound">d</a>

<a id="440" href="ULC.Checks.html#367" class="Function">to-from</a>  <a id="449" class="Symbol">=</a> <a id="451" href="Function.Bundles.html#7570" class="Function">inverseˡ</a> <a id="460" href="ULC.Domains.html#188" class="Postulate">iso</a> <a id="464" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="469" href="ULC.Checks.html#403" class="Function">from-to</a>  <a id="478" class="Symbol">=</a> <a id="480" href="Function.Bundles.html#7642" class="Function">inverseʳ</a> <a id="489" href="ULC.Domains.html#188" class="Postulate">iso</a> <a id="493" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="499" class="Symbol">{-#</a> <a id="503" class="Keyword">REWRITE</a> <a id="511" href="ULC.Checks.html#367" class="Function">to-from</a> <a id="519" class="Symbol">#-}</a>

<a id="524" class="Comment">-- The following proofs are potentially unsound,</a>
<a id="573" class="Comment">-- due to rewriting using the postulated iso</a>

<a id="619" class="Comment">-- (λx1.x1)x42 = x42</a>
<a id="check-id"></a><a id="640" href="ULC.Checks.html#640" class="Function">check-id</a> <a id="649" class="Symbol">:</a>
  <a id="653" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="655" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="659" class="Symbol">(</a><a id="660" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="664" class="Symbol">(</a><a id="665" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="667" class="Number">1</a><a id="668" class="Symbol">)</a> <a id="670" class="Symbol">(</a><a id="671" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="675" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="677" class="Number">1</a><a id="678" class="Symbol">))</a>
        <a id="689" class="Symbol">(</a><a id="690" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="694" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="696" class="Number">42</a><a id="698" class="Symbol">)</a> <a id="700" href="ULC.Semantics.html#144" class="Function Operator">⟧</a> <a id="702" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="704" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="706" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="710" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="712" class="Number">42</a> <a id="715" href="ULC.Semantics.html#144" class="Function Operator">⟧</a>
<a id="717" href="ULC.Checks.html#640" class="Function">check-id</a> <a id="726" class="Symbol">=</a> <a id="728" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="734" class="Comment">-- (λx1.x42)x0 = x42</a>
<a id="check-const"></a><a id="755" href="ULC.Checks.html#755" class="Function">check-const</a> <a id="767" class="Symbol">:</a>
  <a id="771" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="773" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="777" class="Symbol">(</a><a id="778" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="782" class="Symbol">(</a><a id="783" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="785" class="Number">1</a><a id="786" class="Symbol">)</a> <a id="788" class="Symbol">(</a><a id="789" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="793" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="795" class="Number">42</a><a id="797" class="Symbol">))</a>
        <a id="808" class="Symbol">(</a><a id="809" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="813" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="815" class="Number">0</a><a id="816" class="Symbol">)</a> <a id="818" href="ULC.Semantics.html#144" class="Function Operator">⟧</a> <a id="820" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="822" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="824" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="828" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="830" class="Number">42</a> <a id="833" href="ULC.Semantics.html#144" class="Function Operator">⟧</a>
<a id="835" href="ULC.Checks.html#755" class="Function">check-const</a> <a id="847" class="Symbol">=</a> <a id="849" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> 

<a id="856" class="Comment">-- (λx0.x0 x0)(λx0.x0 x0) = ...</a>
<a id="888" class="Comment">-- check-divergence :</a>
<a id="910" class="Comment">--   ⟦ app (lam (x 0) (app (var x 0) (var x 0))) </a>
<a id="960" class="Comment">--         (lam (x 0) (app (var x 0) (var x 0))) ⟧</a>
<a id="1011" class="Comment">--   ≡ ⟦ var x 42 ⟧</a>
<a id="1031" class="Comment">-- check-divergence = refl </a>

<a id="1060" class="Comment">-- (λx1.x42)((λx0.x0 x0)(λx0.x0 x0)) = x42</a>
<a id="check-convergence"></a><a id="1103" href="ULC.Checks.html#1103" class="Function">check-convergence</a> <a id="1121" class="Symbol">:</a>
  <a id="1125" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="1127" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="1131" class="Symbol">(</a><a id="1132" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1136" class="Symbol">(</a><a id="1137" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1139" class="Number">1</a><a id="1140" class="Symbol">)</a> <a id="1142" class="Symbol">(</a><a id="1143" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1147" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1149" class="Number">42</a><a id="1151" class="Symbol">))</a>
        <a id="1162" class="Symbol">(</a><a id="1163" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="1167" class="Symbol">(</a><a id="1168" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1172" class="Symbol">(</a><a id="1173" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1175" class="Number">0</a><a id="1176" class="Symbol">)</a> <a id="1178" class="Symbol">(</a><a id="1179" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="1183" class="Symbol">(</a><a id="1184" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1188" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1190" class="Number">0</a><a id="1191" class="Symbol">)</a> <a id="1193" class="Symbol">(</a><a id="1194" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1198" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1200" class="Number">0</a><a id="1201" class="Symbol">)))</a> 
             <a id="1219" class="Symbol">(</a><a id="1220" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1224" class="Symbol">(</a><a id="1225" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1227" class="Number">0</a><a id="1228" class="Symbol">)</a> <a id="1230" class="Symbol">(</a><a id="1231" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="1235" class="Symbol">(</a><a id="1236" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1240" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1242" class="Number">0</a><a id="1243" class="Symbol">)</a> <a id="1245" class="Symbol">(</a><a id="1246" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1250" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1252" class="Number">0</a><a id="1253" class="Symbol">))))</a> <a id="1258" href="ULC.Semantics.html#144" class="Function Operator">⟧</a>
  <a id="1262" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1264" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="1266" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1270" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1272" class="Number">42</a> <a id="1275" href="ULC.Semantics.html#144" class="Function Operator">⟧</a>
<a id="1277" href="ULC.Checks.html#1103" class="Function">check-convergence</a> <a id="1295" class="Symbol">=</a> <a id="1297" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> 

<a id="1304" class="Comment">-- (λx1.x1)(λx1.x42) = λx2.x42</a>
<a id="check-abs"></a><a id="1335" href="ULC.Checks.html#1335" class="Function">check-abs</a> <a id="1345" class="Symbol">:</a>
  <a id="1349" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="1351" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="1355" class="Symbol">(</a><a id="1356" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1360" class="Symbol">(</a><a id="1361" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1363" class="Number">1</a><a id="1364" class="Symbol">)</a> <a id="1366" class="Symbol">(</a><a id="1367" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1371" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1373" class="Number">1</a><a id="1374" class="Symbol">))</a>
        <a id="1385" class="Symbol">(</a><a id="1386" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1390" class="Symbol">(</a><a id="1391" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1393" class="Number">1</a><a id="1394" class="Symbol">)</a> <a id="1396" class="Symbol">(</a><a id="1397" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1401" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1403" class="Number">42</a><a id="1405" class="Symbol">))</a> <a id="1408" href="ULC.Semantics.html#144" class="Function Operator">⟧</a>
     <a id="1415" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1417" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="1419" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1423" class="Symbol">(</a><a id="1424" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1426" class="Number">2</a><a id="1427" class="Symbol">)</a> <a id="1429" class="Symbol">(</a><a id="1430" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1434" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1436" class="Number">42</a><a id="1438" class="Symbol">)</a> <a id="1440" href="ULC.Semantics.html#144" class="Function Operator">⟧</a>
<a id="1442" href="ULC.Checks.html#1335" class="Function">check-abs</a> <a id="1452" class="Symbol">=</a> <a id="1454" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="1460" class="Comment">-- (λx1.(λx42.x1)x2)x42 = x42</a>
<a id="check-free"></a><a id="1490" href="ULC.Checks.html#1490" class="Function">check-free</a> <a id="1501" class="Symbol">:</a>
  <a id="1505" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="1507" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="1511" class="Symbol">(</a><a id="1512" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1516" class="Symbol">(</a><a id="1517" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1519" class="Number">1</a><a id="1520" class="Symbol">)</a> 
          <a id="1533" class="Symbol">(</a><a id="1534" href="ULC.Terms.html#184" class="InductiveConstructor">app</a> <a id="1538" class="Symbol">(</a><a id="1539" href="ULC.Terms.html#134" class="InductiveConstructor">lam</a> <a id="1543" class="Symbol">(</a><a id="1544" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1546" class="Number">42</a><a id="1548" class="Symbol">)</a> <a id="1550" class="Symbol">(</a><a id="1551" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1555" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1557" class="Number">1</a><a id="1558" class="Symbol">))</a>
               <a id="1576" class="Symbol">(</a><a id="1577" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1581" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1583" class="Number">2</a><a id="1584" class="Symbol">)))</a>
        <a id="1596" class="Symbol">(</a><a id="1597" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1601" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1603" class="Number">42</a><a id="1605" class="Symbol">)</a> <a id="1607" href="ULC.Semantics.html#144" class="Function Operator">⟧</a> <a id="1609" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1611" href="ULC.Semantics.html#144" class="Function Operator">⟦</a> <a id="1613" href="ULC.Terms.html#88" class="InductiveConstructor Operator">var</a> <a id="1617" href="ULC.Variables.html#141" class="InductiveConstructor">x</a> <a id="1619" class="Number">42</a> <a id="1622" href="ULC.Semantics.html#144" class="Function Operator">⟧</a>
<a id="1624" href="ULC.Checks.html#1490" class="Function">check-free</a> <a id="1635" class="Symbol">=</a> <a id="1637" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
</pre> 