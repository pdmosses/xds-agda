\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Scheme.Auxiliary-Functions}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Scheme.Domain-Notation}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Scheme.Domain-Equations}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Scheme.Abstract-Syntax}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{Ide}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Base}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{NonZero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{pred}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ 7.2.4.\ Auxiliary\ functions}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{postulate}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{\AgdaUnderscore{}==ᴵ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Ide}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{Ide}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}[\AgdaUnderscore{}/\AgdaUnderscore{}]}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{𝐔}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{𝐋}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{Ide}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐔}\<%
\\
\>[0]\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{/}}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{◅}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{I′}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{if}}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{==ᴵ}}\AgdaSpace{}%
\AgdaBound{I′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{then}}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{else}}\AgdaSpace{}%
\AgdaField{▻}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{I′}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{lookup}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{𝐔}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{Ide}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{𝐋}\<%
\\
\>[0]\AgdaFunction{lookup}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{▻}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{I}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{extends}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{𝐔}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{Ide}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⋆′}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{𝐋}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⋆}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐔}\<%
\\
\>[0]\AgdaFunction{extends}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{fix}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{extends′}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{λ}%
\>[79I]\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{I⋆′}\AgdaSpace{}%
\AgdaBound{α⋆}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[79I]%
\>[4]\AgdaPostulate{η}%
\>[83I]\AgdaSymbol{(}\AgdaFunction{\#′}\AgdaSpace{}%
\AgdaBound{I⋆′}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{==}}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟶}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{,}}\<%
\\
\>[.][@{}l@{}]\<[83I]%
\>[6]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{(}%
\>[91I]\AgdaSymbol{(}%
\>[92I]\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{I⋆′′}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[92I][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaBound{extends′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{α⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↓}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{/}}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{I⋆′′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{α⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{†}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{♯}}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[91I]%
\>[10]\AgdaSymbol{(}\AgdaBound{I⋆′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↓′}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{♯}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{I⋆′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{†′}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{postulate}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaPostulate{wrong}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{String}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\<%
\\
%
\>[2]\AgdaComment{--\ wrong\ :\ 𝐗\ →\ 𝐂\ --\ implementation-dependent}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{send}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐊}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\<%
\\
\>[0]\AgdaFunction{send}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{ϵ}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{▻}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{ϵ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{single}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐊}\<%
\\
\>[0]\AgdaFunction{single}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{λ}%
\>[144I]\AgdaBound{ψ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{◅}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[144I]%
\>[4]\AgdaSymbol{(}\AgdaFunction{\#}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{==⊥}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟶}}\AgdaSpace{}%
\AgdaBound{ψ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↓}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{,}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaPostulate{wrong}\AgdaSpace{}%
\AgdaString{"wrong\ number\ of\ return\ values"}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{postulate}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaPostulate{new}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{𝐒}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝕃}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{𝐋}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaFunction{𝐗}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaComment{--\ new\ :\ 𝐒\ →\ (𝐋\ +\ \{error\})\ --\ implementation-dependent}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{hold}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{𝐋}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐊}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\<%
\\
\>[0]\AgdaFunction{hold}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{◅}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{▻}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{send}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{▻}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaOperator{\AgdaField{↓1}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{σ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ assign\ :\ 𝐋\ →\ 𝐄\ →\ 𝐂\ →\ 𝐂}\<%
\\
\>[0]\AgdaComment{--\ assign\ =\ λ\ α\ ϵ\ θ\ σ\ →\ θ\ (update\ α\ ϵ\ σ)}\<%
\\
\>[0]\AgdaComment{--\ forward\ reference\ to\ update}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{postulate}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaPostulate{\AgdaUnderscore{}==ᴸ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{𝐋}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{𝐋}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{𝐓}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ R5RS\ and\ [Stoy]\ explain\ \AgdaUnderscore{}[\AgdaUnderscore{}/\AgdaUnderscore{}]\ only\ in\ connection\ with\ environments}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}[\AgdaUnderscore{}/\AgdaUnderscore{}]′}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{𝐒}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaFunction{𝐓}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{𝐋}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐒}\<%
\\
\>[0]\AgdaBound{σ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{/}}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]′}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{◅}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α′}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{α}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{==ᴸ}}\AgdaSpace{}%
\AgdaBound{α′}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟶}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{,}}\AgdaSpace{}%
\AgdaField{▻}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{α′}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{update}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{𝐋}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐒}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐒}\<%
\\
\>[0]\AgdaFunction{update}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaBound{ϵ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ϵ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaPostulate{η}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{/}}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]′}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{assign}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{𝐋}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\<%
\\
\>[0]\AgdaFunction{assign}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaBound{ϵ}\AgdaSpace{}%
\AgdaBound{θ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{◅}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{▻}\AgdaSpace{}%
\AgdaBound{θ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{update}\AgdaSpace{}%
\AgdaBound{α}\AgdaSpace{}%
\AgdaBound{ϵ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{tievals}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{𝐋}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⋆}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⋆}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\<%
\\
\>[0]\AgdaFunction{tievals}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{fix}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{tievals′}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{λ}%
\>[287I]\AgdaBound{ψ}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{◅}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[287I]%
\>[4]\AgdaSymbol{(}\AgdaFunction{\#}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{==⊥}}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟶}}\AgdaSpace{}%
\AgdaField{▻}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ψ}\AgdaSpace{}%
\AgdaFunction{⟨⟩}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{,}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{((}\AgdaPostulate{new}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∈𝐋}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟶}}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaField{▻}%
\>[13]\AgdaSymbol{(}\AgdaBound{tievals′}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{α⋆}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{ψ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaPostulate{new}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{|𝐋}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{§}}\AgdaSpace{}%
\AgdaBound{α⋆}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{†}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{))}\<%
\\
%
\>[13]\AgdaSymbol{(}\AgdaFunction{update}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{new}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{|𝐋}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↓}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{,}}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaField{▻}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{wrong}\AgdaSpace{}%
\AgdaString{"out\ of\ memory"}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{list}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⋆}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐊}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\<%
\\
\>[0]\AgdaComment{--\ Add\ declarations:}\<%
\\
\>[0]\AgdaFunction{dropfirst}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⋆}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{𝐍}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⋆}}\<%
\\
\>[0]\AgdaFunction{takefirst}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⋆}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{𝐍}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⋆}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{tievalsrest}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{𝐋}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⋆}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⋆}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{𝐍}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\<%
\\
\>[0]\AgdaFunction{tievalsrest}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{ψ}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaBound{ν}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{list}%
\>[19]\AgdaSymbol{(}\AgdaFunction{dropfirst}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaBound{ν}\AgdaSymbol{)}\<%
\\
%
\>[19]\AgdaSymbol{(}\AgdaFunction{single}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{ϵ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{tievals}\AgdaSpace{}%
\AgdaBound{ψ}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaFunction{takefirst}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaBound{ν}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{§}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{ϵ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{dropfirst}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{fix}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{dropfirst′}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{λ}%
\>[392I]\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaBound{ν}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[392I]%
\>[4]\AgdaSymbol{(}\AgdaBound{ν}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{==⊥}}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟶}}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{,}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaBound{dropfirst′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{†}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(((}\AgdaPostulate{η}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{pred}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{♯}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ν}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{takefirst}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{fix}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{takefirst′}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{λ}%
\>[413I]\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaBound{ν}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[413I]%
\>[4]\AgdaSymbol{(}\AgdaBound{ν}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{==⊥}}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟶}}\AgdaSpace{}%
\AgdaFunction{⟨⟩}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{,}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↓}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{§}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{takefirst′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{†}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(((}\AgdaPostulate{η}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{pred}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{♯}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ν}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{truish}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{𝐓}\<%
\\
\>[0]\AgdaComment{--\ truish\ =\ λ\ ϵ\ →\ ϵ\ =\ false\ ⟶\ false\ ,\ true}\<%
\\
\>[0]\AgdaFunction{truish}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{ϵ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{misc-false}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{♯}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{▻}\AgdaSpace{}%
\AgdaBound{ϵ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟶}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{η}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{η}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{misc-false}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{𝐐}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaPostulate{𝐇}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaPostulate{𝐑}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaFunction{𝐄𝐩}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaFunction{𝐄𝐯}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaFunction{𝐄𝐬}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaFunction{𝐌}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaPostulate{𝐅}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝕃}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
%
\>[2]\AgdaFunction{misc-false}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj-𝐌}\AgdaSpace{}%
\AgdaBound{μ}\AgdaSymbol{)}%
\>[24]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{((λ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{η}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{η}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{♯}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{μ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{misc-false}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj₁}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}%
\>[24]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{η}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\<%
\\
%
\>[2]\AgdaCatchallClause{\AgdaFunction{misc-false}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{(}}\AgdaCatchallClause{\AgdaInductiveConstructor{inj₂}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{})}}%
\>[24]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{η}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ Added:}\<%
\\
\>[0]\AgdaFunction{misc-undefined}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{𝐐}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaPostulate{𝐇}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaPostulate{𝐑}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaFunction{𝐄𝐩}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaFunction{𝐄𝐯}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaFunction{𝐄𝐬}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaFunction{𝐌}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{+}}\AgdaSpace{}%
\AgdaPostulate{𝐅}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝕃}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{misc-undefined}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj-𝐌}\AgdaSpace{}%
\AgdaBound{μ}\AgdaSymbol{)}%
\>[26]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{((λ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaInductiveConstructor{undefined}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{η}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{η}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{♯}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{μ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{misc-undefined}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj₁}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}%
\>[27]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{η}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\<%
\\
\>[0]\AgdaCatchallClause{\AgdaFunction{misc-undefined}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{(}}\AgdaCatchallClause{\AgdaInductiveConstructor{inj₂}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{})}}%
\>[27]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{η}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ permute\ \ \ \ :\ Exp\ ⋆′\ →\ Exp\ ⋆′\ \ --\ implementation-dependent}\<%
\\
\>[0]\AgdaComment{--\ unpermute\ \ :\ 𝐄\ ⋆\ →\ 𝐄\ ⋆\ \ \ \ \ \ --\ inverse\ of\ permute}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{applicate}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⋆}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐊}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\<%
\\
\>[0]\AgdaFunction{applicate}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{λ}%
\>[552I]\AgdaBound{ϵ}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[552I]%
\>[4]\AgdaSymbol{(}\AgdaBound{ϵ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∈𝐅}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟶}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{▻}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ϵ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{|𝐅}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{↓2}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{,}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaPostulate{wrong}\AgdaSpace{}%
\AgdaString{"bad\ procedure"}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{onearg}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐊}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⋆}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐊}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{onearg}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{λ}%
\>[580I]\AgdaBound{ζ}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[580I]%
\>[4]\AgdaSymbol{(}\AgdaFunction{\#}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{==⊥}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟶}}\AgdaSpace{}%
\AgdaBound{ζ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↓}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{,}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaPostulate{wrong}\AgdaSpace{}%
\AgdaString{"wrong\ number\ of\ arguments"}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{twoarg}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐊}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⋆}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐊}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{twoarg}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{λ}%
\>[611I]\AgdaBound{ζ}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[611I]%
\>[4]\AgdaSymbol{(}\AgdaFunction{\#}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{==⊥}}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟶}}\AgdaSpace{}%
\AgdaBound{ζ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↓}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↓}}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{,}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaPostulate{wrong}\AgdaSpace{}%
\AgdaString{"wrong\ number\ of\ arguments"}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{cons}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{𝐄}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⋆}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐊}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{𝐂}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ list\ :\ 𝐄\ ⋆\ →\ 𝐊\ →\ 𝐂}\<%
\\
\>[0]\AgdaFunction{list}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{fix}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{list′}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{λ}%
\>[641I]\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[641I]%
\>[4]\AgdaSymbol{(}\AgdaFunction{\#}\AgdaSpace{}%
\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{==⊥}}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟶}}\AgdaSpace{}%
\AgdaFunction{send}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{◅}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{η}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj-𝐌}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{η}\AgdaSpace{}%
\AgdaInductiveConstructor{null}\AgdaSymbol{))))}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{,}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaBound{list′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{†}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{single}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{ϵ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{cons}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ϵ⋆}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↓}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ϵ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ cons\ :\ 𝐄\ ⋆\ →\ 𝐊\ →\ 𝐂}\<%
\\
\>[0]\AgdaFunction{cons}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{twoarg}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{λ}%
\>[674I]\AgdaBound{ϵ₁}\AgdaSpace{}%
\AgdaBound{ϵ₂}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{◅}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[674I]%
\>[4]\AgdaSymbol{(}\AgdaPostulate{new}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∈𝐋}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟶}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{σ′}\AgdaSpace{}%
\AgdaSymbol{→}%
\>[687I]\AgdaSymbol{(}\AgdaPostulate{new}\AgdaSpace{}%
\AgdaBound{σ′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∈𝐋}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟶}}\<%
\\
\>[687I][@{}l@{\AgdaIndent{0}}]%
\>[20]\AgdaField{▻}%
\>[691I]\AgdaSymbol{(}\AgdaFunction{send}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaPostulate{new}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{|𝐋}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaPostulate{new}\AgdaSpace{}%
\AgdaBound{σ′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{|𝐋}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{η}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{𝐄𝐩-in-𝐄}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{κ}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[691I]%
\>[22]\AgdaSymbol{(}\AgdaFunction{update}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{new}\AgdaSpace{}%
\AgdaBound{σ′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{|𝐋}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ϵ₂}\AgdaSpace{}%
\AgdaBound{σ′}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{,}}\<%
\\
\>[687I][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaField{▻}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{wrong}\AgdaSpace{}%
\AgdaString{"out\ of\ memory"}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{σ′}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaSymbol{(}\AgdaFunction{update}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{new}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{|𝐋}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ϵ₁}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{,}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaField{▻}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{wrong}\AgdaSpace{}%
\AgdaString{"out\ of\ memory"}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{σ}\<%
\end{code} 