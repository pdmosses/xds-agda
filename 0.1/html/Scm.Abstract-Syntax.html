<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Scm.Abstract-Syntax</title><link rel="stylesheet" href="Agda.css"><script type="text/javascript" src="highlight-hover.js"></script></head><body><pre class="Agda"><a id="1" class="Markup">\begin{code}</a>
<a id="14" class="Symbol">{-#</a> <a id="18" class="Keyword">OPTIONS</a> <a id="26" class="Pragma">--rewriting</a> <a id="38" class="Pragma">--confluence-check</a> <a id="57" class="Pragma">--lossy-unification</a> <a id="77" class="Symbol">#-}</a>

<a id="82" class="Keyword">module</a> <a id="89" href="Scm.Abstract-Syntax.html" class="Module">Scm.Abstract-Syntax</a> <a id="109" class="Keyword">where</a>

<a id="116" class="Keyword">open</a> <a id="121" class="Keyword">import</a> <a id="128" href="Data.Integer.Base.html" class="Module">Data.Integer.Base</a>  <a id="147" class="Keyword">renaming</a> <a id="156" class="Symbol">(</a><a id="157" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a> <a id="159" class="Symbol">to</a> <a id="162" class="Datatype">Int</a><a id="165" class="Symbol">)</a> <a id="167" class="Keyword">public</a>
<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="Data.String.Base.html" class="Module">Data.String.Base</a>   <a id="205" class="Keyword">using</a> <a id="211" class="Symbol">(</a><a id="212" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="218" class="Symbol">)</a> <a id="220" class="Keyword">public</a>

<a id="228" class="Keyword">data</a>       <a id="Con"></a><a id="239" href="Scm.Abstract-Syntax.html#239" class="Datatype">Con</a>    <a id="246" class="Symbol">:</a> <a id="248" href="Agda.Primitive.html#388" class="Primitive">Set</a>     <a id="256" class="Comment">-- constants, *excluding* quotations</a>
<a id="293" class="Keyword">variable</a>   <a id="304" href="Scm.Abstract-Syntax.html#304" class="Generalizable">K</a>      <a id="311" class="Symbol">:</a> <a id="313" href="Scm.Abstract-Syntax.html#239" class="Datatype">Con</a>
<a id="Ide"></a><a id="317" href="Scm.Abstract-Syntax.html#317" class="Function">Ide</a>               <a id="335" class="Symbol">=</a> <a id="337" href="Agda.Builtin.String.html#335" class="Postulate">String</a>  <a id="345" class="Comment">-- identifiers (variables)</a>
<a id="372" class="Keyword">variable</a>   <a id="383" href="Scm.Abstract-Syntax.html#383" class="Generalizable">I</a>      <a id="390" class="Symbol">:</a> <a id="392" href="Scm.Abstract-Syntax.html#317" class="Function">Ide</a>
<a id="396" class="Keyword">data</a>       <a id="Exp"></a><a id="407" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a>    <a id="414" class="Symbol">:</a> <a id="416" href="Agda.Primitive.html#388" class="Primitive">Set</a>     <a id="424" class="Comment">-- expressions</a>
<a id="439" class="Keyword">variable</a>   <a id="450" href="Scm.Abstract-Syntax.html#450" class="Generalizable">E</a>      <a id="457" class="Symbol">:</a> <a id="459" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a>
<a id="463" class="Keyword">data</a>       <a id="Exp⋆"></a><a id="474" href="Scm.Abstract-Syntax.html#474" class="Datatype">Exp⋆</a>   <a id="481" class="Symbol">:</a> <a id="483" href="Agda.Primitive.html#388" class="Primitive">Set</a>     <a id="491" class="Comment">-- expression sequences</a>
<a id="515" class="Keyword">variable</a>   <a id="526" href="Scm.Abstract-Syntax.html#526" class="Generalizable">E⋆</a>     <a id="533" class="Symbol">:</a> <a id="535" href="Scm.Abstract-Syntax.html#474" class="Datatype">Exp⋆</a>

<a id="541" class="Keyword">data</a>       <a id="Body"></a><a id="552" href="Scm.Abstract-Syntax.html#552" class="Datatype">Body</a>   <a id="559" class="Symbol">:</a> <a id="561" href="Agda.Primitive.html#388" class="Primitive">Set</a>     <a id="569" class="Comment">-- body expression or definition</a>
<a id="602" class="Keyword">variable</a>   <a id="613" href="Scm.Abstract-Syntax.html#613" class="Generalizable">B</a>      <a id="620" class="Symbol">:</a> <a id="622" href="Scm.Abstract-Syntax.html#552" class="Datatype">Body</a>
<a id="627" class="Keyword">data</a>       <a id="Body⁺"></a><a id="638" href="Scm.Abstract-Syntax.html#638" class="Datatype">Body⁺</a>  <a id="645" class="Symbol">:</a> <a id="647" href="Agda.Primitive.html#388" class="Primitive">Set</a>     <a id="655" class="Comment">-- body sequences</a>
<a id="673" class="Keyword">variable</a>   <a id="684" href="Scm.Abstract-Syntax.html#684" class="Generalizable">B⁺</a>     <a id="691" class="Symbol">:</a> <a id="693" href="Scm.Abstract-Syntax.html#638" class="Datatype">Body⁺</a>
<a id="699" class="Keyword">data</a>       <a id="Prog"></a><a id="710" href="Scm.Abstract-Syntax.html#710" class="Datatype">Prog</a>   <a id="717" class="Symbol">:</a> <a id="719" href="Agda.Primitive.html#388" class="Primitive">Set</a>     <a id="727" class="Comment">-- programs</a>
<a id="739" class="Keyword">variable</a>   <a id="750" href="Scm.Abstract-Syntax.html#750" class="Generalizable">Π</a>      <a id="757" class="Symbol">:</a> <a id="759" href="Scm.Abstract-Syntax.html#710" class="Datatype">Prog</a>

<a id="765" class="Comment">------------------------------------------------------------------------</a>
<a id="838" class="Comment">-- Literal constants</a>

<a id="860" class="Keyword">data</a> <a id="865" href="Scm.Abstract-Syntax.html#239" class="Datatype">Con</a> <a id="869" class="Keyword">where</a>                <a id="890" class="Comment">-- basic constants</a>
  <a id="Con.int"></a><a id="911" href="Scm.Abstract-Syntax.html#911" class="InductiveConstructor">int</a>  <a id="916" class="Symbol">:</a> <a id="918" href="Scm.Abstract-Syntax.html#162" class="Datatype">Int</a> <a id="922" class="Symbol">→</a> <a id="924" href="Scm.Abstract-Syntax.html#239" class="Datatype">Con</a>            <a id="939" class="Comment">-- integer numerals</a>
  <a id="Con.#t"></a><a id="961" href="Scm.Abstract-Syntax.html#961" class="InductiveConstructor">#t</a>   <a id="966" class="Symbol">:</a> <a id="968" href="Scm.Abstract-Syntax.html#239" class="Datatype">Con</a>                  <a id="989" class="Comment">-- true</a>
  <a id="Con.#f"></a><a id="999" href="Scm.Abstract-Syntax.html#999" class="InductiveConstructor">#f</a>   <a id="1004" class="Symbol">:</a> <a id="1006" href="Scm.Abstract-Syntax.html#239" class="Datatype">Con</a>                  <a id="1027" class="Comment">-- false</a>

<a id="1037" class="Comment">------------------------------------------------------------------------</a>
<a id="1110" class="Comment">-- Expressions</a>

<a id="1126" class="Keyword">data</a> <a id="1131" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a> <a id="1135" class="Keyword">where</a>                          <a id="1166" class="Comment">-- expressions</a>
  <a id="Exp.con"></a><a id="1183" href="Scm.Abstract-Syntax.html#1183" class="InductiveConstructor">con</a>          <a id="1196" class="Symbol">:</a> <a id="1198" href="Scm.Abstract-Syntax.html#239" class="Datatype">Con</a> <a id="1202" class="Symbol">→</a> <a id="1204" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a>              <a id="1221" class="Comment">-- K</a>
  <a id="Exp.ide"></a><a id="1228" href="Scm.Abstract-Syntax.html#1228" class="InductiveConstructor">ide</a>          <a id="1241" class="Symbol">:</a> <a id="1243" href="Scm.Abstract-Syntax.html#317" class="Function">Ide</a> <a id="1247" class="Symbol">→</a> <a id="1249" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a>              <a id="1266" class="Comment">-- I</a>
  <a id="Exp.⦅_␣_⦆"></a><a id="1273" href="Scm.Abstract-Syntax.html#1273" class="InductiveConstructor Operator">⦅_␣_⦆</a>        <a id="1286" class="Symbol">:</a> <a id="1288" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a> <a id="1292" class="Symbol">→</a> <a id="1294" href="Scm.Abstract-Syntax.html#474" class="Datatype">Exp⋆</a> <a id="1299" class="Symbol">→</a> <a id="1301" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a>       <a id="1311" class="Comment">-- (E E⋆)</a>
  <a id="Exp.⦅lambda_␣_⦆"></a><a id="1323" href="Scm.Abstract-Syntax.html#1323" class="InductiveConstructor Operator">⦅lambda_␣_⦆</a>  <a id="1336" class="Symbol">:</a> <a id="1338" href="Scm.Abstract-Syntax.html#317" class="Function">Ide</a> <a id="1342" class="Symbol">→</a> <a id="1344" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a> <a id="1348" class="Symbol">→</a> <a id="1350" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a>        <a id="1361" class="Comment">-- (lambda I E)</a>
  <a id="Exp.⦅if_␣_␣_⦆"></a><a id="1379" href="Scm.Abstract-Syntax.html#1379" class="InductiveConstructor Operator">⦅if_␣_␣_⦆</a>    <a id="1392" class="Symbol">:</a> <a id="1394" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a> <a id="1398" class="Symbol">→</a> <a id="1400" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a> <a id="1404" class="Symbol">→</a> <a id="1406" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a> <a id="1410" class="Symbol">→</a> <a id="1412" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a>  <a id="1417" class="Comment">-- (if E E₁ E₂)</a>
  <a id="Exp.⦅set!_␣_⦆"></a><a id="1435" href="Scm.Abstract-Syntax.html#1435" class="InductiveConstructor Operator">⦅set!_␣_⦆</a>    <a id="1448" class="Symbol">:</a> <a id="1450" href="Scm.Abstract-Syntax.html#317" class="Function">Ide</a> <a id="1454" class="Symbol">→</a> <a id="1456" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a> <a id="1460" class="Symbol">→</a> <a id="1462" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a>        <a id="1473" class="Comment">-- (set! I E)</a>

<a id="1488" class="Keyword">data</a> <a id="1493" href="Scm.Abstract-Syntax.html#474" class="Datatype">Exp⋆</a> <a id="1498" class="Keyword">where</a>                         <a id="1528" class="Comment">-- expression sequences</a>
  <a id="Exp⋆.␣␣␣"></a><a id="1554" href="Scm.Abstract-Syntax.html#1554" class="InductiveConstructor">␣␣␣</a>          <a id="1567" class="Symbol">:</a> <a id="1569" href="Scm.Abstract-Syntax.html#474" class="Datatype">Exp⋆</a>                   <a id="1592" class="Comment">-- empty sequence</a>
  <a id="Exp⋆._␣␣_"></a><a id="1612" href="Scm.Abstract-Syntax.html#1612" class="InductiveConstructor Operator">_␣␣_</a>         <a id="1625" class="Symbol">:</a> <a id="1627" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a> <a id="1631" class="Symbol">→</a> <a id="1633" href="Scm.Abstract-Syntax.html#474" class="Datatype">Exp⋆</a> <a id="1638" class="Symbol">→</a> <a id="1640" href="Scm.Abstract-Syntax.html#474" class="Datatype">Exp⋆</a>      <a id="1650" class="Comment">-- prefix sequence E E⋆</a>
<a id="1674" class="Markup">\end{code}</a><a id="1684" class="Background">
\iflatex
\clearpage
\fi
</a><a id="1709" class="Markup">\begin{code}</a>
<a id="1722" class="Comment">------------------------------------------------------------------------</a>
<a id="1795" class="Comment">-- Definitions and Programs</a>

<a id="1824" class="Keyword">data</a> <a id="1829" href="Scm.Abstract-Syntax.html#552" class="Datatype">Body</a> <a id="1834" class="Keyword">where</a>
  <a id="Body.␣␣_"></a><a id="1842" href="Scm.Abstract-Syntax.html#1842" class="InductiveConstructor Operator">␣␣_</a>          <a id="1855" class="Symbol">:</a> <a id="1857" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a> <a id="1861" class="Symbol">→</a> <a id="1863" href="Scm.Abstract-Syntax.html#552" class="Datatype">Body</a>             <a id="1880" class="Comment">-- side-effect expression E</a>
  <a id="Body.⦅define_␣_⦆"></a><a id="1910" href="Scm.Abstract-Syntax.html#1910" class="InductiveConstructor Operator">⦅define_␣_⦆</a>  <a id="1923" class="Symbol">:</a> <a id="1925" href="Scm.Abstract-Syntax.html#317" class="Function">Ide</a> <a id="1929" class="Symbol">→</a> <a id="1931" href="Scm.Abstract-Syntax.html#407" class="Datatype">Exp</a> <a id="1935" class="Symbol">→</a> <a id="1937" href="Scm.Abstract-Syntax.html#552" class="Datatype">Body</a>       <a id="1948" class="Comment">-- definition (define I E)</a>
  <a id="Body.⦅begin_⦆"></a><a id="1977" href="Scm.Abstract-Syntax.html#1977" class="InductiveConstructor Operator">⦅begin_⦆</a>     <a id="1990" class="Symbol">:</a> <a id="1992" href="Scm.Abstract-Syntax.html#638" class="Datatype">Body⁺</a> <a id="1998" class="Symbol">→</a> <a id="2000" href="Scm.Abstract-Syntax.html#552" class="Datatype">Body</a>           <a id="2015" class="Comment">-- block (begin B⁺)</a>

<a id="2036" class="Keyword">data</a> <a id="2041" href="Scm.Abstract-Syntax.html#638" class="Datatype">Body⁺</a> <a id="2047" class="Keyword">where</a>                        <a id="2076" class="Comment">-- body sequence</a>
  <a id="Body⁺.␣␣_"></a><a id="2095" href="Scm.Abstract-Syntax.html#2095" class="InductiveConstructor Operator">␣␣_</a>          <a id="2108" class="Symbol">:</a> <a id="2110" href="Scm.Abstract-Syntax.html#552" class="Datatype">Body</a> <a id="2115" class="Symbol">→</a> <a id="2117" href="Scm.Abstract-Syntax.html#638" class="Datatype">Body⁺</a>           <a id="2133" class="Comment">-- single body sequence B</a>
  <a id="Body⁺._␣␣_"></a><a id="2161" href="Scm.Abstract-Syntax.html#2161" class="InductiveConstructor Operator">_␣␣_</a>         <a id="2174" class="Symbol">:</a> <a id="2176" href="Scm.Abstract-Syntax.html#552" class="Datatype">Body</a> <a id="2181" class="Symbol">→</a> <a id="2183" href="Scm.Abstract-Syntax.html#638" class="Datatype">Body⁺</a> <a id="2189" class="Symbol">→</a> <a id="2191" href="Scm.Abstract-Syntax.html#638" class="Datatype">Body⁺</a>   <a id="2199" class="Comment">-- prefix body sequence B B⁺</a>

<a id="2229" class="Keyword">data</a> <a id="2234" href="Scm.Abstract-Syntax.html#710" class="Datatype">Prog</a> <a id="2239" class="Keyword">where</a>                         <a id="2269" class="Comment">-- programs</a>
  <a id="Prog.␣␣␣"></a><a id="2283" href="Scm.Abstract-Syntax.html#2283" class="InductiveConstructor">␣␣␣</a>          <a id="2296" class="Symbol">:</a> <a id="2298" href="Scm.Abstract-Syntax.html#710" class="Datatype">Prog</a>                   <a id="2321" class="Comment">-- empty program</a>
  <a id="Prog.␣␣_"></a><a id="2340" href="Scm.Abstract-Syntax.html#2340" class="InductiveConstructor Operator">␣␣_</a>          <a id="2353" class="Symbol">:</a> <a id="2355" href="Scm.Abstract-Syntax.html#638" class="Datatype">Body⁺</a> <a id="2361" class="Symbol">→</a> <a id="2363" href="Scm.Abstract-Syntax.html#710" class="Datatype">Prog</a>           <a id="2378" class="Comment">-- non-empty program B⁺</a>

<a id="2403" class="Keyword">infix</a> <a id="2409" class="Number">30</a> <a id="2412" href="Scm.Abstract-Syntax.html#2340" class="InductiveConstructor Operator">␣␣_</a>
<a id="2416" class="Keyword">infixr</a> <a id="2423" class="Number">20</a> <a id="2426" href="Scm.Abstract-Syntax.html#2161" class="InductiveConstructor Operator">_␣␣_</a>
<a id="2431" class="Markup">\end{code}</a></pre></body></html>