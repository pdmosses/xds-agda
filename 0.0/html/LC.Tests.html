<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>LC.Tests</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Markup">\begin{code}</a>
<a id="14" class="Symbol">{-#</a> <a id="18" class="Keyword">OPTIONS</a> <a id="26" class="Pragma">--rewriting</a> <a id="38" class="Pragma">--confluence-check</a> <a id="57" class="Symbol">#-}</a>

<a id="62" class="Keyword">open</a> <a id="67" class="Keyword">import</a> <a id="74" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>
<a id="96" class="Keyword">open</a> <a id="101" class="Keyword">import</a> <a id="108" href="Agda.Builtin.Equality.Rewrite.html" class="Module">Agda.Builtin.Equality.Rewrite</a>

<a id="139" class="Keyword">module</a> <a id="146" href="LC.Tests.html" class="Module">LC.Tests</a> <a id="155" class="Keyword">where</a>

<a id="162" class="Keyword">open</a> <a id="167" class="Keyword">import</a> <a id="174" href="LC.Domains.html" class="Module">LC.Domains</a>
<a id="185" class="Keyword">open</a> <a id="190" class="Keyword">import</a> <a id="197" href="LC.Variables.html" class="Module">LC.Variables</a>
<a id="210" class="Keyword">open</a> <a id="215" class="Keyword">import</a> <a id="222" href="LC.Terms.html" class="Module">LC.Terms</a>
<a id="231" class="Keyword">open</a> <a id="236" class="Keyword">import</a> <a id="243" href="LC.Semantics.html" class="Module">LC.Semantics</a>

<a id="257" class="Keyword">open</a> <a id="262" class="Keyword">import</a> <a id="269" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="307" class="Keyword">using</a> <a id="313" class="Symbol">(</a><a id="314" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="318" class="Symbol">)</a>
<a id="320" class="Keyword">open</a> <a id="325" href="Function.Bundles.html#7338" class="Module">Inverse</a> <a id="333" class="Keyword">using</a> <a id="339" class="Symbol">(</a><a id="340" href="Function.Bundles.html#7568" class="Function">inverseˡ</a><a id="348" class="Symbol">;</a> <a id="350" href="Function.Bundles.html#7640" class="Function">inverseʳ</a><a id="358" class="Symbol">)</a>

<a id="to-from-elim"></a><a id="361" href="LC.Tests.html#361" class="Function">to-from-elim</a> <a id="374" class="Symbol">:</a> <a id="376" class="Symbol">∀</a> <a id="378" class="Symbol">{</a><a id="379" href="LC.Tests.html#379" class="Bound">f</a><a id="380" class="Symbol">}</a>  <a id="383" class="Symbol">→</a>  <a id="386" href="Function.Bundles.html#7392" class="Field">to</a> <a id="389" class="Symbol">(</a><a id="390" href="Function.Bundles.html#7416" class="Field">from</a> <a id="395" href="LC.Tests.html#379" class="Bound">f</a><a id="396" class="Symbol">)</a>  <a id="399" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="401" href="LC.Tests.html#379" class="Bound">f</a>
<a id="403" href="LC.Tests.html#361" class="Function">to-from-elim</a>  <a id="417" class="Symbol">=</a> <a id="419" href="Function.Bundles.html#7568" class="Function">inverseˡ</a> <a id="428" href="LC.Domains.html#222" class="Postulate">iso</a> <a id="432" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="from-to-elim"></a><a id="438" href="LC.Tests.html#438" class="Function">from-to-elim</a> <a id="451" class="Symbol">:</a> <a id="453" class="Symbol">∀</a> <a id="455" class="Symbol">{</a><a id="456" href="LC.Tests.html#456" class="Bound">d</a><a id="457" class="Symbol">}</a>  <a id="460" class="Symbol">→</a>  <a id="463" href="Function.Bundles.html#7416" class="Field">from</a> <a id="468" class="Symbol">(</a><a id="469" href="Function.Bundles.html#7392" class="Field">to</a> <a id="472" href="LC.Tests.html#456" class="Bound">d</a><a id="473" class="Symbol">)</a>  <a id="476" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="478" href="LC.Tests.html#456" class="Bound">d</a>
<a id="480" href="LC.Tests.html#438" class="Function">from-to-elim</a>  <a id="494" class="Symbol">=</a> <a id="496" href="Function.Bundles.html#7640" class="Function">inverseʳ</a> <a id="505" href="LC.Domains.html#222" class="Postulate">iso</a> <a id="509" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="515" class="Symbol">{-#</a> <a id="519" class="Keyword">REWRITE</a> <a id="527" href="LC.Tests.html#361" class="Function">to-from-elim</a> <a id="540" class="Symbol">#-}</a>

<a id="545" class="Comment">-- The following proofs are potentially unsound,</a>
<a id="594" class="Comment">-- due to rewriting using the postulated iso</a>

<a id="640" class="Comment">-- (λx1.x1)x42 = x42</a>
<a id="check-id"></a><a id="661" href="LC.Tests.html#661" class="Function">check-id</a> <a id="670" class="Symbol">:</a>
  <a id="674" href="LC.Semantics.html#139" class="Function Operator">⟦</a> <a id="676" href="LC.Terms.html#182" class="InductiveConstructor">app</a> <a id="680" class="Symbol">(</a><a id="681" href="LC.Terms.html#132" class="InductiveConstructor">lam</a> <a id="685" class="Symbol">(</a><a id="686" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="688" class="Number">1</a><a id="689" class="Symbol">)</a> <a id="691" class="Symbol">(</a><a id="692" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="696" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="698" class="Number">1</a><a id="699" class="Symbol">))</a>
        <a id="710" class="Symbol">(</a><a id="711" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="715" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="717" class="Number">42</a><a id="719" class="Symbol">)</a> <a id="721" href="LC.Semantics.html#139" class="Function Operator">⟧</a> <a id="723" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="725" href="LC.Semantics.html#139" class="Function Operator">⟦</a> <a id="727" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="731" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="733" class="Number">42</a> <a id="736" href="LC.Semantics.html#139" class="Function Operator">⟧</a>
<a id="738" href="LC.Tests.html#661" class="Function">check-id</a> <a id="747" class="Symbol">=</a> <a id="749" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="755" class="Comment">-- (λx1.x42)x0 = x42</a>
<a id="check-const"></a><a id="776" href="LC.Tests.html#776" class="Function">check-const</a> <a id="788" class="Symbol">:</a>
  <a id="792" href="LC.Semantics.html#139" class="Function Operator">⟦</a> <a id="794" href="LC.Terms.html#182" class="InductiveConstructor">app</a> <a id="798" class="Symbol">(</a><a id="799" href="LC.Terms.html#132" class="InductiveConstructor">lam</a> <a id="803" class="Symbol">(</a><a id="804" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="806" class="Number">1</a><a id="807" class="Symbol">)</a> <a id="809" class="Symbol">(</a><a id="810" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="814" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="816" class="Number">42</a><a id="818" class="Symbol">))</a>
        <a id="829" class="Symbol">(</a><a id="830" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="834" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="836" class="Number">0</a><a id="837" class="Symbol">)</a> <a id="839" href="LC.Semantics.html#139" class="Function Operator">⟧</a> <a id="841" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="843" href="LC.Semantics.html#139" class="Function Operator">⟦</a> <a id="845" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="849" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="851" class="Number">42</a> <a id="854" href="LC.Semantics.html#139" class="Function Operator">⟧</a>
<a id="856" href="LC.Tests.html#776" class="Function">check-const</a> <a id="868" class="Symbol">=</a> <a id="870" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> 

<a id="877" class="Comment">-- (λx0.x0 x0)(λx0.x0 x0) = ...</a>
<a id="909" class="Comment">-- check-divergence :</a>
<a id="931" class="Comment">--   ⟦ app (lam (x 0) (app (var x 0) (var x 0))) </a>
<a id="981" class="Comment">--         (lam (x 0) (app (var x 0) (var x 0))) ⟧</a>
<a id="1032" class="Comment">--   ≡ ⟦ var x 42 ⟧</a>
<a id="1052" class="Comment">-- check-divergence = refl </a>

<a id="1081" class="Comment">-- (λx1.x42)((λx0.x0 x0)(λx0.x0 x0)) = x42</a>
<a id="check-convergence"></a><a id="1124" href="LC.Tests.html#1124" class="Function">check-convergence</a> <a id="1142" class="Symbol">:</a>
  <a id="1146" href="LC.Semantics.html#139" class="Function Operator">⟦</a> <a id="1148" href="LC.Terms.html#182" class="InductiveConstructor">app</a> <a id="1152" class="Symbol">(</a><a id="1153" href="LC.Terms.html#132" class="InductiveConstructor">lam</a> <a id="1157" class="Symbol">(</a><a id="1158" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1160" class="Number">1</a><a id="1161" class="Symbol">)</a> <a id="1163" class="Symbol">(</a><a id="1164" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="1168" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1170" class="Number">42</a><a id="1172" class="Symbol">))</a>
        <a id="1183" class="Symbol">(</a><a id="1184" href="LC.Terms.html#182" class="InductiveConstructor">app</a> <a id="1188" class="Symbol">(</a><a id="1189" href="LC.Terms.html#132" class="InductiveConstructor">lam</a> <a id="1193" class="Symbol">(</a><a id="1194" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1196" class="Number">0</a><a id="1197" class="Symbol">)</a> <a id="1199" class="Symbol">(</a><a id="1200" href="LC.Terms.html#182" class="InductiveConstructor">app</a> <a id="1204" class="Symbol">(</a><a id="1205" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="1209" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1211" class="Number">0</a><a id="1212" class="Symbol">)</a> <a id="1214" class="Symbol">(</a><a id="1215" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="1219" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1221" class="Number">0</a><a id="1222" class="Symbol">)))</a> 
             <a id="1240" class="Symbol">(</a><a id="1241" href="LC.Terms.html#132" class="InductiveConstructor">lam</a> <a id="1245" class="Symbol">(</a><a id="1246" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1248" class="Number">0</a><a id="1249" class="Symbol">)</a> <a id="1251" class="Symbol">(</a><a id="1252" href="LC.Terms.html#182" class="InductiveConstructor">app</a> <a id="1256" class="Symbol">(</a><a id="1257" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="1261" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1263" class="Number">0</a><a id="1264" class="Symbol">)</a> <a id="1266" class="Symbol">(</a><a id="1267" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="1271" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1273" class="Number">0</a><a id="1274" class="Symbol">))))</a> <a id="1279" href="LC.Semantics.html#139" class="Function Operator">⟧</a>
  <a id="1283" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1285" href="LC.Semantics.html#139" class="Function Operator">⟦</a> <a id="1287" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="1291" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1293" class="Number">42</a> <a id="1296" href="LC.Semantics.html#139" class="Function Operator">⟧</a>
<a id="1298" href="LC.Tests.html#1124" class="Function">check-convergence</a> <a id="1316" class="Symbol">=</a> <a id="1318" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> 

<a id="1325" class="Comment">-- (λx1.x1)(λx1.x42) = λx2.x42</a>
<a id="check-abs"></a><a id="1356" href="LC.Tests.html#1356" class="Function">check-abs</a> <a id="1366" class="Symbol">:</a>
  <a id="1370" href="LC.Semantics.html#139" class="Function Operator">⟦</a> <a id="1372" href="LC.Terms.html#182" class="InductiveConstructor">app</a> <a id="1376" class="Symbol">(</a><a id="1377" href="LC.Terms.html#132" class="InductiveConstructor">lam</a> <a id="1381" class="Symbol">(</a><a id="1382" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1384" class="Number">1</a><a id="1385" class="Symbol">)</a> <a id="1387" class="Symbol">(</a><a id="1388" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="1392" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1394" class="Number">1</a><a id="1395" class="Symbol">))</a>
        <a id="1406" class="Symbol">(</a><a id="1407" href="LC.Terms.html#132" class="InductiveConstructor">lam</a> <a id="1411" class="Symbol">(</a><a id="1412" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1414" class="Number">1</a><a id="1415" class="Symbol">)</a> <a id="1417" class="Symbol">(</a><a id="1418" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="1422" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1424" class="Number">42</a><a id="1426" class="Symbol">))</a> <a id="1429" href="LC.Semantics.html#139" class="Function Operator">⟧</a>
     <a id="1436" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1438" href="LC.Semantics.html#139" class="Function Operator">⟦</a> <a id="1440" href="LC.Terms.html#132" class="InductiveConstructor">lam</a> <a id="1444" class="Symbol">(</a><a id="1445" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1447" class="Number">2</a><a id="1448" class="Symbol">)</a> <a id="1450" class="Symbol">(</a><a id="1451" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="1455" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1457" class="Number">42</a><a id="1459" class="Symbol">)</a> <a id="1461" href="LC.Semantics.html#139" class="Function Operator">⟧</a>
<a id="1463" href="LC.Tests.html#1356" class="Function">check-abs</a> <a id="1473" class="Symbol">=</a> <a id="1475" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="1481" class="Comment">-- (λx1.(λx42.x1)x2)x42 = x42</a>
<a id="check-free"></a><a id="1511" href="LC.Tests.html#1511" class="Function">check-free</a> <a id="1522" class="Symbol">:</a>
  <a id="1526" href="LC.Semantics.html#139" class="Function Operator">⟦</a> <a id="1528" href="LC.Terms.html#182" class="InductiveConstructor">app</a> <a id="1532" class="Symbol">(</a><a id="1533" href="LC.Terms.html#132" class="InductiveConstructor">lam</a> <a id="1537" class="Symbol">(</a><a id="1538" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1540" class="Number">1</a><a id="1541" class="Symbol">)</a> 
          <a id="1554" class="Symbol">(</a><a id="1555" href="LC.Terms.html#182" class="InductiveConstructor">app</a> <a id="1559" class="Symbol">(</a><a id="1560" href="LC.Terms.html#132" class="InductiveConstructor">lam</a> <a id="1564" class="Symbol">(</a><a id="1565" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1567" class="Number">42</a><a id="1569" class="Symbol">)</a> <a id="1571" class="Symbol">(</a><a id="1572" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="1576" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1578" class="Number">1</a><a id="1579" class="Symbol">))</a>
               <a id="1597" class="Symbol">(</a><a id="1598" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="1602" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1604" class="Number">2</a><a id="1605" class="Symbol">)))</a>
        <a id="1617" class="Symbol">(</a><a id="1618" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="1622" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1624" class="Number">42</a><a id="1626" class="Symbol">)</a> <a id="1628" href="LC.Semantics.html#139" class="Function Operator">⟧</a> <a id="1630" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1632" href="LC.Semantics.html#139" class="Function Operator">⟦</a> <a id="1634" href="LC.Terms.html#86" class="InductiveConstructor Operator">var</a> <a id="1638" href="LC.Variables.html#140" class="InductiveConstructor">x</a> <a id="1640" class="Number">42</a> <a id="1643" href="LC.Semantics.html#139" class="Function Operator">⟧</a>
<a id="1645" href="LC.Tests.html#1511" class="Function">check-free</a> <a id="1656" class="Symbol">=</a> <a id="1658" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="1663" class="Markup">\end{code}</a><a id="1673" class="Background"> </a></pre></body></html>