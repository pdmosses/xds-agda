<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Scm.Abstract-Syntax</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Markup">\begin{code}</a>
<a id="14" class="Keyword">module</a> <a id="21" href="Scm.Abstract-Syntax.html" class="Module">Scm.Abstract-Syntax</a> <a id="41" class="Keyword">where</a>

<a id="48" class="Keyword">open</a> <a id="53" class="Keyword">import</a> <a id="60" href="Data.Integer.Base.html" class="Module">Data.Integer.Base</a>  <a id="79" class="Keyword">renaming</a> <a id="88" class="Symbol">(</a><a id="89" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a> <a id="91" class="Symbol">to</a> <a id="94" class="Datatype">Int</a><a id="97" class="Symbol">)</a> <a id="99" class="Keyword">public</a>
<a id="106" class="Keyword">open</a> <a id="111" class="Keyword">import</a> <a id="118" href="Data.String.Base.html" class="Module">Data.String.Base</a>   <a id="137" class="Keyword">using</a> <a id="143" class="Symbol">(</a><a id="144" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="150" class="Symbol">)</a> <a id="152" class="Keyword">public</a>

<a id="160" class="Keyword">data</a>       <a id="Con"></a><a id="171" href="Scm.Abstract-Syntax.html#171" class="Datatype">Con</a>    <a id="178" class="Symbol">:</a> <a id="180" href="Agda.Primitive.html#388" class="Primitive">Set</a>     <a id="188" class="Comment">-- constants, *excluding* quotations</a>
<a id="225" class="Keyword">variable</a>   <a id="236" href="Scm.Abstract-Syntax.html#236" class="Generalizable">K</a>      <a id="243" class="Symbol">:</a> <a id="245" href="Scm.Abstract-Syntax.html#171" class="Datatype">Con</a>
<a id="Ide"></a><a id="249" href="Scm.Abstract-Syntax.html#249" class="Function">Ide</a>               <a id="267" class="Symbol">=</a> <a id="269" href="Agda.Builtin.String.html#335" class="Postulate">String</a>  <a id="277" class="Comment">-- identifiers (variables)</a>
<a id="304" class="Keyword">variable</a>   <a id="315" href="Scm.Abstract-Syntax.html#315" class="Generalizable">I</a>      <a id="322" class="Symbol">:</a> <a id="324" href="Scm.Abstract-Syntax.html#249" class="Function">Ide</a>
<a id="328" class="Keyword">data</a>       <a id="Exp"></a><a id="339" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a>    <a id="346" class="Symbol">:</a> <a id="348" href="Agda.Primitive.html#388" class="Primitive">Set</a>     <a id="356" class="Comment">-- expressions</a>
<a id="371" class="Keyword">variable</a>   <a id="382" href="Scm.Abstract-Syntax.html#382" class="Generalizable">E</a>      <a id="389" class="Symbol">:</a> <a id="391" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a>
<a id="395" class="Keyword">data</a>       <a id="Exp⋆"></a><a id="406" href="Scm.Abstract-Syntax.html#406" class="Datatype">Exp⋆</a>   <a id="413" class="Symbol">:</a> <a id="415" href="Agda.Primitive.html#388" class="Primitive">Set</a>     <a id="423" class="Comment">-- expression sequences</a>
<a id="447" class="Keyword">variable</a>   <a id="458" href="Scm.Abstract-Syntax.html#458" class="Generalizable">E⋆</a>     <a id="465" class="Symbol">:</a> <a id="467" href="Scm.Abstract-Syntax.html#406" class="Datatype">Exp⋆</a>

<a id="473" class="Keyword">data</a>       <a id="Body"></a><a id="484" href="Scm.Abstract-Syntax.html#484" class="Datatype">Body</a>   <a id="491" class="Symbol">:</a> <a id="493" href="Agda.Primitive.html#388" class="Primitive">Set</a>     <a id="501" class="Comment">-- body expression or definition</a>
<a id="534" class="Keyword">variable</a>   <a id="545" href="Scm.Abstract-Syntax.html#545" class="Generalizable">B</a>      <a id="552" class="Symbol">:</a> <a id="554" href="Scm.Abstract-Syntax.html#484" class="Datatype">Body</a>
<a id="559" class="Keyword">data</a>       <a id="Body⁺"></a><a id="570" href="Scm.Abstract-Syntax.html#570" class="Datatype">Body⁺</a>  <a id="577" class="Symbol">:</a> <a id="579" href="Agda.Primitive.html#388" class="Primitive">Set</a>     <a id="587" class="Comment">-- body sequences</a>
<a id="605" class="Keyword">variable</a>   <a id="616" href="Scm.Abstract-Syntax.html#616" class="Generalizable">B⁺</a>     <a id="623" class="Symbol">:</a> <a id="625" href="Scm.Abstract-Syntax.html#570" class="Datatype">Body⁺</a>
<a id="631" class="Keyword">data</a>       <a id="Prog"></a><a id="642" href="Scm.Abstract-Syntax.html#642" class="Datatype">Prog</a>   <a id="649" class="Symbol">:</a> <a id="651" href="Agda.Primitive.html#388" class="Primitive">Set</a>     <a id="659" class="Comment">-- programs</a>
<a id="671" class="Keyword">variable</a>   <a id="682" href="Scm.Abstract-Syntax.html#682" class="Generalizable">Π</a>      <a id="689" class="Symbol">:</a> <a id="691" href="Scm.Abstract-Syntax.html#642" class="Datatype">Prog</a>

<a id="697" class="Comment">------------------------------------------------------------------------</a>
<a id="770" class="Comment">-- Literal constants</a>

<a id="792" class="Keyword">data</a> <a id="797" href="Scm.Abstract-Syntax.html#171" class="Datatype">Con</a> <a id="801" class="Keyword">where</a>                <a id="822" class="Comment">-- basic constants</a>
  <a id="Con.int"></a><a id="843" href="Scm.Abstract-Syntax.html#843" class="InductiveConstructor">int</a>  <a id="848" class="Symbol">:</a> <a id="850" href="Scm.Abstract-Syntax.html#94" class="Datatype">Int</a> <a id="854" class="Symbol">→</a> <a id="856" href="Scm.Abstract-Syntax.html#171" class="Datatype">Con</a>            <a id="871" class="Comment">-- integer numerals</a>
  <a id="Con.#t"></a><a id="893" href="Scm.Abstract-Syntax.html#893" class="InductiveConstructor">#t</a>   <a id="898" class="Symbol">:</a> <a id="900" href="Scm.Abstract-Syntax.html#171" class="Datatype">Con</a>                  <a id="921" class="Comment">-- true</a>
  <a id="Con.#f"></a><a id="931" href="Scm.Abstract-Syntax.html#931" class="InductiveConstructor">#f</a>   <a id="936" class="Symbol">:</a> <a id="938" href="Scm.Abstract-Syntax.html#171" class="Datatype">Con</a>                  <a id="959" class="Comment">-- false</a>

<a id="969" class="Comment">------------------------------------------------------------------------</a>
<a id="1042" class="Comment">-- Expressions</a>

<a id="1058" class="Keyword">data</a> <a id="1063" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a> <a id="1067" class="Keyword">where</a>                          <a id="1098" class="Comment">-- expressions</a>
  <a id="Exp.con"></a><a id="1115" href="Scm.Abstract-Syntax.html#1115" class="InductiveConstructor">con</a>          <a id="1128" class="Symbol">:</a> <a id="1130" href="Scm.Abstract-Syntax.html#171" class="Datatype">Con</a> <a id="1134" class="Symbol">→</a> <a id="1136" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a>              <a id="1153" class="Comment">-- K</a>
  <a id="Exp.ide"></a><a id="1160" href="Scm.Abstract-Syntax.html#1160" class="InductiveConstructor">ide</a>          <a id="1173" class="Symbol">:</a> <a id="1175" href="Scm.Abstract-Syntax.html#249" class="Function">Ide</a> <a id="1179" class="Symbol">→</a> <a id="1181" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a>              <a id="1198" class="Comment">-- I</a>
  <a id="Exp.⦅_␣_⦆"></a><a id="1205" href="Scm.Abstract-Syntax.html#1205" class="InductiveConstructor Operator">⦅_␣_⦆</a>        <a id="1218" class="Symbol">:</a> <a id="1220" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a> <a id="1224" class="Symbol">→</a> <a id="1226" href="Scm.Abstract-Syntax.html#406" class="Datatype">Exp⋆</a> <a id="1231" class="Symbol">→</a> <a id="1233" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a>       <a id="1243" class="Comment">-- (E E⋆)</a>
  <a id="Exp.⦅lambda_␣_⦆"></a><a id="1255" href="Scm.Abstract-Syntax.html#1255" class="InductiveConstructor Operator">⦅lambda_␣_⦆</a>  <a id="1268" class="Symbol">:</a> <a id="1270" href="Scm.Abstract-Syntax.html#249" class="Function">Ide</a> <a id="1274" class="Symbol">→</a> <a id="1276" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a> <a id="1280" class="Symbol">→</a> <a id="1282" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a>        <a id="1293" class="Comment">-- (lambda I E)</a>
  <a id="Exp.⦅if_␣_␣_⦆"></a><a id="1311" href="Scm.Abstract-Syntax.html#1311" class="InductiveConstructor Operator">⦅if_␣_␣_⦆</a>    <a id="1324" class="Symbol">:</a> <a id="1326" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a> <a id="1330" class="Symbol">→</a> <a id="1332" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a> <a id="1336" class="Symbol">→</a> <a id="1338" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a> <a id="1342" class="Symbol">→</a> <a id="1344" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a>  <a id="1349" class="Comment">-- (if E E₁ E₂)</a>
  <a id="Exp.⦅set!_␣_⦆"></a><a id="1367" href="Scm.Abstract-Syntax.html#1367" class="InductiveConstructor Operator">⦅set!_␣_⦆</a>    <a id="1380" class="Symbol">:</a> <a id="1382" href="Scm.Abstract-Syntax.html#249" class="Function">Ide</a> <a id="1386" class="Symbol">→</a> <a id="1388" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a> <a id="1392" class="Symbol">→</a> <a id="1394" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a>        <a id="1405" class="Comment">-- (set! I E)</a>

<a id="1420" class="Keyword">data</a> <a id="1425" href="Scm.Abstract-Syntax.html#406" class="Datatype">Exp⋆</a> <a id="1430" class="Keyword">where</a>                         <a id="1460" class="Comment">-- expression sequences</a>
  <a id="Exp⋆.␣␣␣"></a><a id="1486" href="Scm.Abstract-Syntax.html#1486" class="InductiveConstructor">␣␣␣</a>          <a id="1499" class="Symbol">:</a> <a id="1501" href="Scm.Abstract-Syntax.html#406" class="Datatype">Exp⋆</a>                   <a id="1524" class="Comment">-- empty sequence</a>
  <a id="Exp⋆._␣␣_"></a><a id="1544" href="Scm.Abstract-Syntax.html#1544" class="InductiveConstructor Operator">_␣␣_</a>         <a id="1557" class="Symbol">:</a> <a id="1559" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a> <a id="1563" class="Symbol">→</a> <a id="1565" href="Scm.Abstract-Syntax.html#406" class="Datatype">Exp⋆</a> <a id="1570" class="Symbol">→</a> <a id="1572" href="Scm.Abstract-Syntax.html#406" class="Datatype">Exp⋆</a>      <a id="1582" class="Comment">-- prefix sequence E E⋆</a>
<a id="1606" class="Markup">\end{code}</a><a id="1616" class="Background">
\iflatex
\clearpage
\fi
</a><a id="1641" class="Markup">\begin{code}</a>
<a id="1654" class="Comment">------------------------------------------------------------------------</a>
<a id="1727" class="Comment">-- Definitions and Programs</a>

<a id="1756" class="Keyword">data</a> <a id="1761" href="Scm.Abstract-Syntax.html#484" class="Datatype">Body</a> <a id="1766" class="Keyword">where</a>
  <a id="Body.␣␣_"></a><a id="1774" href="Scm.Abstract-Syntax.html#1774" class="InductiveConstructor Operator">␣␣_</a>          <a id="1787" class="Symbol">:</a> <a id="1789" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a> <a id="1793" class="Symbol">→</a> <a id="1795" href="Scm.Abstract-Syntax.html#484" class="Datatype">Body</a>             <a id="1812" class="Comment">-- side-effect expression E</a>
  <a id="Body.⦅define_␣_⦆"></a><a id="1842" href="Scm.Abstract-Syntax.html#1842" class="InductiveConstructor Operator">⦅define_␣_⦆</a>  <a id="1855" class="Symbol">:</a> <a id="1857" href="Scm.Abstract-Syntax.html#249" class="Function">Ide</a> <a id="1861" class="Symbol">→</a> <a id="1863" href="Scm.Abstract-Syntax.html#339" class="Datatype">Exp</a> <a id="1867" class="Symbol">→</a> <a id="1869" href="Scm.Abstract-Syntax.html#484" class="Datatype">Body</a>       <a id="1880" class="Comment">-- definition (define I E)</a>
  <a id="Body.⦅begin_⦆"></a><a id="1909" href="Scm.Abstract-Syntax.html#1909" class="InductiveConstructor Operator">⦅begin_⦆</a>     <a id="1922" class="Symbol">:</a> <a id="1924" href="Scm.Abstract-Syntax.html#570" class="Datatype">Body⁺</a> <a id="1930" class="Symbol">→</a> <a id="1932" href="Scm.Abstract-Syntax.html#484" class="Datatype">Body</a>           <a id="1947" class="Comment">-- block (begin B⁺)</a>

<a id="1968" class="Keyword">data</a> <a id="1973" href="Scm.Abstract-Syntax.html#570" class="Datatype">Body⁺</a> <a id="1979" class="Keyword">where</a>                        <a id="2008" class="Comment">-- body sequence</a>
  <a id="Body⁺.␣␣_"></a><a id="2027" href="Scm.Abstract-Syntax.html#2027" class="InductiveConstructor Operator">␣␣_</a>          <a id="2040" class="Symbol">:</a> <a id="2042" href="Scm.Abstract-Syntax.html#484" class="Datatype">Body</a> <a id="2047" class="Symbol">→</a> <a id="2049" href="Scm.Abstract-Syntax.html#570" class="Datatype">Body⁺</a>           <a id="2065" class="Comment">-- single body sequence B</a>
  <a id="Body⁺._␣␣_"></a><a id="2093" href="Scm.Abstract-Syntax.html#2093" class="InductiveConstructor Operator">_␣␣_</a>         <a id="2106" class="Symbol">:</a> <a id="2108" href="Scm.Abstract-Syntax.html#484" class="Datatype">Body</a> <a id="2113" class="Symbol">→</a> <a id="2115" href="Scm.Abstract-Syntax.html#570" class="Datatype">Body⁺</a> <a id="2121" class="Symbol">→</a> <a id="2123" href="Scm.Abstract-Syntax.html#570" class="Datatype">Body⁺</a>   <a id="2131" class="Comment">-- prefix body sequence B B⁺</a>

<a id="2161" class="Keyword">data</a> <a id="2166" href="Scm.Abstract-Syntax.html#642" class="Datatype">Prog</a> <a id="2171" class="Keyword">where</a>                         <a id="2201" class="Comment">-- programs</a>
  <a id="Prog.␣␣␣"></a><a id="2215" href="Scm.Abstract-Syntax.html#2215" class="InductiveConstructor">␣␣␣</a>          <a id="2228" class="Symbol">:</a> <a id="2230" href="Scm.Abstract-Syntax.html#642" class="Datatype">Prog</a>                   <a id="2253" class="Comment">-- empty program</a>
  <a id="Prog.␣␣_"></a><a id="2272" href="Scm.Abstract-Syntax.html#2272" class="InductiveConstructor Operator">␣␣_</a>          <a id="2285" class="Symbol">:</a> <a id="2287" href="Scm.Abstract-Syntax.html#570" class="Datatype">Body⁺</a> <a id="2293" class="Symbol">→</a> <a id="2295" href="Scm.Abstract-Syntax.html#642" class="Datatype">Prog</a>           <a id="2310" class="Comment">-- non-empty program B⁺</a>

<a id="2335" class="Keyword">infix</a> <a id="2341" class="Number">30</a> <a id="2344" href="Scm.Abstract-Syntax.html#2272" class="InductiveConstructor Operator">␣␣_</a>
<a id="2348" class="Keyword">infixr</a> <a id="2355" class="Number">20</a> <a id="2358" href="Scm.Abstract-Syntax.html#2093" class="InductiveConstructor Operator">_␣␣_</a>
<a id="2363" class="Markup">\end{code}</a></pre></body></html>